<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="AnnotationGx">
<title>Querying PubChem • AnnotationGx</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Querying PubChem">
<meta property="og:description" content="AnnotationGx">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">AnnotationGx</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9089</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Introduction.html">Introduction to AnnotationGx</a>
    <a class="dropdown-item" href="../articles/Cellosaurus.html">Querying Cellosaurus</a>
    <a class="dropdown-item" href="../articles/ChEMBL.html">Querying ChEMBL Database</a>
    <a class="dropdown-item" href="../articles/OncoTree.html">Querying OncoTree</a>
    <a class="dropdown-item" href="../articles/PubChemAPI.html">Querying PubChem</a>
    <a class="dropdown-item" href="../articles/Unichem.html">Querying Unichem Database</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Querying PubChem</h1>
            
      
      
      <div class="d-none name"><code>PubChemAPI.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction-to-pubchem-apis">Introduction to PubChem APIs<a class="anchor" aria-label="anchor" href="#introduction-to-pubchem-apis"></a>
</h2>
<p>PubChem is a database of chemical molecules and their biological
activities. It is a part of the National Center for Biotechnology
Information (NCBI), which is a part of the National Institutes of Health
(NIH). PubChem provides a set of APIs to query its database. The
<code>AnnotationGx</code> package provides a set of functions to query
PubChem using these APIs.</p>
<p>The first of these APIs is the <code>PubChem PUG REST API</code>
which is designed to - make specific queries based on some input
<em>identifier</em> and return data which PubChem has labelled or
computed internally [1]. - This API is useful for querying information
about a specific chemical compound such as getting the standardized
PubChem identifier (CID) for a given chemical name or smiles string, or
getting the chemical structure for a given CID. - It provides access to
a wide range of data including chemical properties, bioassay data, and
chemical classification data, given a specific identifier.</p>
<p>The second API is the <code>PubChem PUG VIEW API</code> which is
designed to: - give accesse to aggregated annotations for a given
chemical compound [3] that is mapped to their data, but not curated by
PubChem itself. - i.e it provides access to annotations from external
sources such as UniProt, ChEBI, and ChEMBL, given a specific
identifier.</p>
</div>
<div class="section level2">
<h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bhklab.github.io/AnnotationGx/">AnnotationGx</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="mapping-from-chemical-name-to-pubchem-cid">Mapping from chemical name to PubChem CID<a class="anchor" aria-label="anchor" href="#mapping-from-chemical-name-to-pubchem-cid"></a>
</h2>
<p>The main function that is provided by the package is
<code>mapCompound2CID</code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mapCompound2CID.html">mapCompound2CID</a></span><span class="op">(</span><span class="st">"aspirin"</span><span class="op">)</span></span>
<span><span class="co">#&gt;       name  cids</span></span>
<span><span class="co">#&gt;     &lt;char&gt; &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1: aspirin  2244</span></span></code></pre></div>
<p>You can pass in a list of compound names to get the CIDs for all of
them at once.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">drugs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"Aspirin"</span>, <span class="st">"Erlotinib"</span>, <span class="st">"Acadesine"</span>, <span class="st">"Camptothecin"</span>, <span class="st">"Vincaleukoblastine"</span>,</span>
<span>  <span class="st">"Cisplatin"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/mapCompound2CID.html">mapCompound2CID</a></span><span class="op">(</span><span class="va">drugs</span><span class="op">)</span></span>
<span><span class="co">#&gt;                  name    cids</span></span>
<span><span class="co">#&gt;                &lt;char&gt;   &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1:            Aspirin    2244</span></span>
<span><span class="co">#&gt; 2:          Erlotinib  176870</span></span>
<span><span class="co">#&gt; 3:          Acadesine   17513</span></span>
<span><span class="co">#&gt; 4:       Camptothecin   24360</span></span>
<span><span class="co">#&gt; 5: Vincaleukoblastine   13342</span></span>
<span><span class="co">#&gt; 6: Vincaleukoblastine  241903</span></span>
<span><span class="co">#&gt; 7: Vincaleukoblastine 3823887</span></span>
<span><span class="co">#&gt; 8:          Cisplatin 5702198</span></span></code></pre></div>
<p>It is possible for names to multimap to CIDs. This is the case for
‘<em>Vincaleukoblastine</em>’ in the above query. In cases of
multimapping, usually the first entry has the highest similarity to the
requested drug. To subset to only the first occurrence of each of drug
name:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mapCompound2CID.html">mapCompound2CID</a></span><span class="op">(</span><span class="va">drugs</span>, first <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt;                  name    cids</span></span>
<span><span class="co">#&gt;                &lt;char&gt;   &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1:            Aspirin    2244</span></span>
<span><span class="co">#&gt; 2:          Erlotinib  176870</span></span>
<span><span class="co">#&gt; 3:          Acadesine   17513</span></span>
<span><span class="co">#&gt; 4:       Camptothecin   24360</span></span>
<span><span class="co">#&gt; 5: Vincaleukoblastine   13342</span></span>
<span><span class="co">#&gt; 6:          Cisplatin 5702198</span></span></code></pre></div>
<p>In the case of a compound that can’t be mapped, <code>NA</code> will
be returned and a warning will be issued.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mapCompound2CID.html">mapCompound2CID</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">drugs</span>, <span class="st">"non existent compound"</span>, <span class="st">"another bad compound"</span><span class="op">)</span>, first <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">[20:21:47][WARNING][AnnotationGx::getPubchemCompound] Some queries failed. See the 'failed' object for details.  </span></span></span>
<span><span class="co">#&gt;                     name    cids</span></span>
<span><span class="co">#&gt;                   &lt;char&gt;   &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1:               Aspirin    2244</span></span>
<span><span class="co">#&gt; 2:             Erlotinib  176870</span></span>
<span><span class="co">#&gt; 3:             Acadesine   17513</span></span>
<span><span class="co">#&gt; 4:          Camptothecin   24360</span></span>
<span><span class="co">#&gt; 5:    Vincaleukoblastine   13342</span></span>
<span><span class="co">#&gt; 6:             Cisplatin 5702198</span></span>
<span><span class="co">#&gt; 7: non existent compound      NA</span></span>
<span><span class="co">#&gt; 8:  another bad compound      NA</span></span>
<span></span>
<span><span class="va">failed</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span><span class="op">$</span><span class="va">failed</span></span>
<span></span>
<span><span class="co"># get the list of failed inputs</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">failed</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "non existent compound" "another bad compound"</span></span>
<span></span>
<span><span class="co"># get the error message for the failed input</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">failed</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; $`non existent compound`</span></span>
<span><span class="co">#&gt; $`non existent compound`$Code</span></span>
<span><span class="co">#&gt; [1] "PUGREST.NotFound"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`non existent compound`$Message</span></span>
<span><span class="co">#&gt; [1] "No CID found"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`non existent compound`$Details</span></span>
<span><span class="co">#&gt; [1] "No CID found that matches the given name"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="mapping-from-pubchem-cid-to-properties">Mapping from PubChem CID to Properties<a class="anchor" aria-label="anchor" href="#mapping-from-pubchem-cid-to-properties"></a>
</h2>
<p>Once CIDs are obtained, they can be used to query the properties of
the compound. To view the available properties from Pubchem, use the
<code>getPubchemProperties</code> function.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/getPubchemProperties.html">getPubchemProperties</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;                         name         type</span></span>
<span><span class="co">#&gt;                       &lt;char&gt;       &lt;char&gt;</span></span>
<span><span class="co">#&gt;  1:                      CID          int</span></span>
<span><span class="co">#&gt;  2:         MolecularFormula       string</span></span>
<span><span class="co">#&gt;  3:          MolecularWeight       string</span></span>
<span><span class="co">#&gt;  4:          CanonicalSMILES       string</span></span>
<span><span class="co">#&gt;  5:           IsomericSMILES       string</span></span>
<span><span class="co">#&gt;  6:                    InChI       string</span></span>
<span><span class="co">#&gt;  7:                 InChIKey       string</span></span>
<span><span class="co">#&gt;  8:                IUPACName       string</span></span>
<span><span class="co">#&gt;  9:                    XLogP       double</span></span>
<span><span class="co">#&gt; 10:                ExactMass       string</span></span>
<span><span class="co">#&gt; 11:         MonoisotopicMass       string</span></span>
<span><span class="co">#&gt; 12:                     TPSA       double</span></span>
<span><span class="co">#&gt; 13:               Complexity          int</span></span>
<span><span class="co">#&gt; 14:                   Charge          int</span></span>
<span><span class="co">#&gt; 15:          HBondDonorCount          int</span></span>
<span><span class="co">#&gt; 16:       HBondAcceptorCount          int</span></span>
<span><span class="co">#&gt; 17:       RotatableBondCount          int</span></span>
<span><span class="co">#&gt; 18:           HeavyAtomCount          int</span></span>
<span><span class="co">#&gt; 19:         IsotopeAtomCount          int</span></span>
<span><span class="co">#&gt; 20:          AtomStereoCount          int</span></span>
<span><span class="co">#&gt; 21:   DefinedAtomStereoCount          int</span></span>
<span><span class="co">#&gt; 22: UndefinedAtomStereoCount          int</span></span>
<span><span class="co">#&gt; 23:          BondStereoCount          int</span></span>
<span><span class="co">#&gt; 24:   DefinedBondStereoCount          int</span></span>
<span><span class="co">#&gt; 25: UndefinedBondStereoCount          int</span></span>
<span><span class="co">#&gt; 26:        CovalentUnitCount          int</span></span>
<span><span class="co">#&gt; 27:                 Volume3D       double</span></span>
<span><span class="co">#&gt; 28:      XStericQuadrupole3D       double</span></span>
<span><span class="co">#&gt; 29:      YStericQuadrupole3D       double</span></span>
<span><span class="co">#&gt; 30:      ZStericQuadrupole3D       double</span></span>
<span><span class="co">#&gt; 31:           FeatureCount3D          int</span></span>
<span><span class="co">#&gt; 32:   FeatureAcceptorCount3D          int</span></span>
<span><span class="co">#&gt; 33:      FeatureDonorCount3D          int</span></span>
<span><span class="co">#&gt; 34:      FeatureAnionCount3D          int</span></span>
<span><span class="co">#&gt; 35:     FeatureCationCount3D          int</span></span>
<span><span class="co">#&gt; 36:       FeatureRingCount3D          int</span></span>
<span><span class="co">#&gt; 37: FeatureHydrophobeCount3D          int</span></span>
<span><span class="co">#&gt; 38:     ConformerModelRMSD3D       double</span></span>
<span><span class="co">#&gt; 39:    EffectiveRotorCount3D       double</span></span>
<span><span class="co">#&gt; 40:         ConformerCount3D          int</span></span>
<span><span class="co">#&gt; 41:            Fingerprint2D base64Binary</span></span>
<span><span class="co">#&gt; 42:                    Title       string</span></span>
<span><span class="co">#&gt; 43:              PatentCount          int</span></span>
<span><span class="co">#&gt; 44:        PatentFamilyCount          int</span></span>
<span><span class="co">#&gt; 45:          LiteratureCount          int</span></span>
<span><span class="co">#&gt;                         name         type</span></span></code></pre></div>
<p>After deciding which properties to query, you can use the
<code>mapCID2Properties</code> function to get the properties for a
specific CID.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">properties</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Title"</span>, <span class="st">"MolecularFormula"</span>, <span class="st">"InChIKey"</span>, <span class="st">"MolecularWeight"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Need to remove NA values from the query as they will cause an error</span></span>
<span><span class="va">result</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">cids</span><span class="op">)</span>, <span class="fu"><a href="../reference/mapCID2Properties.html">mapCID2Properties</a></span><span class="op">(</span>ids <span class="op">=</span> <span class="va">cids</span>, properties <span class="op">=</span> <span class="va">properties</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt;        CID MolecularFormula MolecularWeight                    InChIKey</span></span>
<span><span class="co">#&gt;      &lt;int&gt;           &lt;char&gt;          &lt;char&gt;                      &lt;char&gt;</span></span>
<span><span class="co">#&gt; 1:    2244           C9H8O4          180.16 BSYNRYMUTXBXSQ-UHFFFAOYSA-N</span></span>
<span><span class="co">#&gt; 2:  176870       C22H23N3O4           393.4 AAKJLRGGTJKAMG-UHFFFAOYSA-N</span></span>
<span><span class="co">#&gt; 3:   17513        C9H14N4O5          258.23 RTRQQBHATOEIAF-UUOKFMHZSA-N</span></span>
<span><span class="co">#&gt; 4:   24360       C20H16N2O4           348.4 VSJKWCGYPAHWDS-FQEVSTJZSA-N</span></span>
<span><span class="co">#&gt; 5:   13342       C46H58N4O9           811.0 JXLYSJRDGCGARV-CFWMRBGOSA-N</span></span>
<span><span class="co">#&gt; 6: 5702198        Cl2H6N2Pt          300.05 LXZZYRPGZAFOLE-UHFFFAOYSA-L</span></span>
<span><span class="co">#&gt;                     Title</span></span>
<span><span class="co">#&gt;                    &lt;char&gt;</span></span>
<span><span class="co">#&gt; 1:                Aspirin</span></span>
<span><span class="co">#&gt; 2:              Erlotinib</span></span>
<span><span class="co">#&gt; 3:              Acadesine</span></span>
<span><span class="co">#&gt; 4:           Camptothecin</span></span>
<span><span class="co">#&gt; 5:            Vinblastine</span></span>
<span><span class="co">#&gt; 6: azane;dichloroplatinum</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="mapping-from-pubchem-cid-to-annotations">Mapping from PubChem CID to Annotations<a class="anchor" aria-label="anchor" href="#mapping-from-pubchem-cid-to-annotations"></a>
</h2>
<p>Pubchem’s VIEW API provides access to annotations from external
sources such as UniProt, ChEBI, and ChEMBL, given a specific identifier.
Before querying annotations, we need to use the exact heading we want to
query.</p>
<p>You can use the <code>getPubchemAnnotationHeadings</code> function to
get the available annotation headings and types.</p>
<div class="section level4">
<h4 id="get-all-available-annotation-headings">Get ALL available annotation headings:<a class="anchor" aria-label="anchor" href="#get-all-available-annotation-headings"></a>
</h4>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/getPubchemAnnotationHeadings.html">getPubchemAnnotationHeadings</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;               Heading     Type</span></span>
<span><span class="co">#&gt;                &lt;char&gt;   &lt;char&gt;</span></span>
<span><span class="co">#&gt;   1:  11B NMR Spectra Compound</span></span>
<span><span class="co">#&gt;   2:  13C NMR Spectra Compound</span></span>
<span><span class="co">#&gt;   3:  15N NMR Spectra Compound</span></span>
<span><span class="co">#&gt;   4:  17O NMR Spectra Compound</span></span>
<span><span class="co">#&gt;   5:  19F NMR Spectra Compound</span></span>
<span><span class="co">#&gt;  ---                          </span></span>
<span><span class="co">#&gt; 636: Wiley References Compound</span></span>
<span><span class="co">#&gt; 637:      WormBase ID     Gene</span></span>
<span><span class="co">#&gt; 638:      WormBase ID  Protein</span></span>
<span><span class="co">#&gt; 639:  Xenbase Gene ID     Gene</span></span>
<span><span class="co">#&gt; 640:          ZFIN ID     Gene</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="get-annotation-headings-for-a-specific-type">Get annotation headings for a specific type:<a class="anchor" aria-label="anchor" href="#get-annotation-headings-for-a-specific-type"></a>
</h4>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/getPubchemAnnotationHeadings.html">getPubchemAnnotationHeadings</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"Compound"</span><span class="op">)</span></span>
<span><span class="co">#&gt;                                        Heading     Type</span></span>
<span><span class="co">#&gt;                                         &lt;char&gt;   &lt;char&gt;</span></span>
<span><span class="co">#&gt;   1:                           11B NMR Spectra Compound</span></span>
<span><span class="co">#&gt;   2:                           13C NMR Spectra Compound</span></span>
<span><span class="co">#&gt;   3:                           15N NMR Spectra Compound</span></span>
<span><span class="co">#&gt;   4:                           17O NMR Spectra Compound</span></span>
<span><span class="co">#&gt;   5:                           19F NMR Spectra Compound</span></span>
<span><span class="co">#&gt;  ---                                                   </span></span>
<span><span class="co">#&gt; 475: Volatilization from Water/Soil (Complete) Compound</span></span>
<span><span class="co">#&gt; 476:                   WHO Essential Medicines Compound</span></span>
<span><span class="co">#&gt; 477:                                  Wikidata Compound</span></span>
<span><span class="co">#&gt; 478:                                 Wikipedia Compound</span></span>
<span><span class="co">#&gt; 479:                          Wiley References Compound</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="get-annotation-headings-for-a-specific-heading">Get annotation headings for a specific heading:<a class="anchor" aria-label="anchor" href="#get-annotation-headings-for-a-specific-heading"></a>
</h4>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/getPubchemAnnotationHeadings.html">getPubchemAnnotationHeadings</a></span><span class="op">(</span>heading <span class="op">=</span> <span class="st">"ChEMBL ID"</span><span class="op">)</span></span>
<span><span class="co">#&gt;      Heading     Type</span></span>
<span><span class="co">#&gt;       &lt;char&gt;   &lt;char&gt;</span></span>
<span><span class="co">#&gt; 1: ChEMBL ID Compound</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="get-annotation-headings-for-a-specific-type-and-heading">Get annotation headings for a specific type <strong>and</strong>
heading:<a class="anchor" aria-label="anchor" href="#get-annotation-headings-for-a-specific-type-and-heading"></a>
</h4>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/getPubchemAnnotationHeadings.html">getPubchemAnnotationHeadings</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"Compound"</span>, heading <span class="op">=</span> <span class="st">"CAS"</span><span class="op">)</span></span>
<span><span class="co">#&gt;           Heading     Type</span></span>
<span><span class="co">#&gt;            &lt;char&gt;   &lt;char&gt;</span></span>
<span><span class="co">#&gt; 1:            CAS Compound</span></span>
<span><span class="co">#&gt; 2: Deprecated CAS Compound</span></span>
<span><span class="co">#&gt; 3:    Related CAS Compound</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="query-annotations-for-a-specific-cid-and-heading">Query annotations for a specific CID and heading<a class="anchor" aria-label="anchor" href="#query-annotations-for-a-specific-cid-and-heading"></a>
</h4>
<p>We can then use the heading to query the annotations for a specific
CID.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">cids</span><span class="op">)</span>, <span class="va">CAS</span> <span class="op">:=</span> <span class="fu"><a href="../reference/annotatePubchemCompound.html">annotatePubchemCompound</a></span><span class="op">(</span><span class="va">cids</span>, <span class="st">"CAS"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">result</span></span>
<span><span class="co">#&gt;                     name    cids         CAS</span></span>
<span><span class="co">#&gt;                   &lt;char&gt;   &lt;int&gt;      &lt;char&gt;</span></span>
<span><span class="co">#&gt; 1:               Aspirin    2244     50-78-2</span></span>
<span><span class="co">#&gt; 2:             Erlotinib  176870 183321-74-6</span></span>
<span><span class="co">#&gt; 3:             Acadesine   17513   2627-69-2</span></span>
<span><span class="co">#&gt; 4:          Camptothecin   24360   7689-03-4</span></span>
<span><span class="co">#&gt; 5:    Vincaleukoblastine   13342    865-21-4</span></span>
<span><span class="co">#&gt; 6:             Cisplatin 5702198        &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 7: non existent compound      NA        &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 8:  another bad compound      NA        &lt;NA&gt;</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ol style="list-style-type: decimal">
<li>PUG REST. PubChem Docs [website]. Retrieved from <a href="https://pubchemdocs.ncbi.nlm.nih.gov/pug-rest" class="external-link uri">https://pubchemdocs.ncbi.nlm.nih.gov/pug-rest</a>.</li>
<li>Kim S, Thiessen PA, Cheng T, Yu B, Bolton EE. An update on PUG-REST:
RESTful interface for programmatic access to PubChem. Nucleic Acids Res.
2018 July 2; 46(W1):W563-570. <a href="doi:10.1093/nar/gky294" class="uri">doi:10.1093/nar/gky294</a>.</li>
<li>PUG VIEW. PubChem Docs [webiste]. Retrieved from <a href="https://pubchemdocs.ncbi.nlm.nih.gov/pug-view" class="external-link uri">https://pubchemdocs.ncbi.nlm.nih.gov/pug-view</a>.</li>
<li>Kim S, Thiessen PA, Cheng T, Zhang J, Gindulyte A, Bolton EE.
PUG-View: programmatic access to chemical annotations integrated in
PubChem. J Cheminform. 2019 Aug 9; 11:56. <a href="doi:10.1186/s13321-019-0375-2" class="uri">doi:10.1186/s13321-019-0375-2</a>.</li>
</ol>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Jermiah Joseph, Christopher Eeles, Benjamin Haibe-Kains.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
