<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="AnnotationGx">
<title>Querying PubChem with AnnotationGx • AnnotationGx</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Querying PubChem with AnnotationGx">
<meta property="og:description" content="AnnotationGx">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">AnnotationGx</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.4.9001</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/ChEMBLAPIQueries.html">Querying ChEMBL with AnnotationGx</a>
    <a class="dropdown-item" href="../articles/PubChemAPIQueries.html">Querying PubChem with AnnotationGx</a>
    <a class="dropdown-item" href="../articles/UniChemAPIQueries.html">Querying UniChem with AnnotationGx</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Querying PubChem with AnnotationGx</h1>
                        <h4 data-toc-skip class="author">Christopher Eeles</h4>
            
      
      
      <div class="d-none name"><code>PubChemAPIQueries.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction-to-pubchem-apis">Introduction to PubChem APIs<a class="anchor" aria-label="anchor" href="#introduction-to-pubchem-apis"></a>
</h2>
<p>PubChem provides two publicly available RESTful APIs for programatically accessing data in their databases. The first of these, the PubChem PUG REST API, is designed to make specific queries based on some input identifier and return data which PubChem has labelled or computed internally [1]. This API can be used to do things like get standardized PubChem identifiers CID or SID from drug names, external database identifiers, etc. The second is the PubChem PUG VIEW API [2]. This interface allows access to a variety of data which are aggregated by PubChem to display along with their own records, but are not curated by PubChem itself.</p>
<div class="section level3">
<h3 id="pubchem-pug-rest-api">PubChem PUG REST API<a class="anchor" aria-label="anchor" href="#pubchem-pug-rest-api"></a>
</h3>
<p>This package inlcudes functions for making arbitrary queries to the PubChem REST API. The most fundamental of these is the <code>getRequestPubChem</code> function, which uses its parameters to construct a single GET request to the PUG REST API, returning an <code><a href="https://httr.r-lib.org/reference/response.html" class="external-link">httr::response</a></code> object. The documentation for this function also includes the most detail about the structure of the PUG REST API, and developers wishing to write custom queries for this package should review the documentation with <code><a href="../reference/getRequestPubChem.html">?getRequestPubChem</a></code>.</p>
<p>For convenience, a wrapper function, <code>queryRequestPubChem</code>, is available which automatically converts the results to a <code>data.frame</code> using <code><a href="https://rdrr.io/pkg/jsonlite/man/fromJSON.html" class="external-link">jsonlite::fromJSON</a></code>. This function only works when <code>output</code> parameter is set to <code>JSON</code>.</p>
<p>The major workhorse for PubChem queries in this package is the <code>queryPubChem</code> function. This function is able to batch queries such that multiple identifiers are mapped per GET request. It also implements parallelized queries as well as query throttling to ensure users do not exceed the 5 query per second, 400 query per minute limits imposed by PubChem. Both <code>getRequestPubChem</code> and <code>queryRequestPubChem</code> use the <code>...</code> parameter to pass arguments through to <code>getRequestPubChem</code>. As such, users should review the <code>getRequestPubChem</code> documentation prior to using either query functions.</p>
<p>Two additional parameters are added in <code>queryPubChem</code>. The <code>batch</code> query tells the function whether to use multiple identifiers per GET request. This parameter should be set to <code>TRUE</code> (the default) unless you are retrying failed queries. This is because batch queries fail completely if ANY of their their ids fail to map. The <code>raw</code> parameter is included for debugging purposes, This can be used to diagnose HTTP errors using the <code>httr::headers(response)</code> function.</p>
<p>Use of <code>queryPubChem</code> is mainly intended for developers, and beginners with this package should focus on using the more specialized functions described below. It is worth noting, however, that all specialized functions were constructed using <code>queryPubChem</code>.</p>
<p>The PUG REST API is divided into multiple domains, each representing a distinct entity in the PubChem Schema. Details of these domains can be found in <code><a href="../reference/getRequestPubChem.html">?getRequestPubChem</a></code>. The three most important domains are discussed below.</p>
<div class="section level4">
<h4 id="querying-the-compound-domain">Querying the Compound Domain<a class="anchor" aria-label="anchor" href="#querying-the-compound-domain"></a>
</h4>
<p>The compound domain allows users to make queries on pharmacologically relevant entities such as drugs. The main PubChem id for compounds is Compound IDentifier (CID). Each CID may map to one or more Substance IDentifiers (SID). In this context, SID is a less stable identifier, possibly only contributed by a single source and not yet standardized. CIDs on the otherhand, have stable PubChem entries and normalized names which are generally supported accross multiple data sources. As such, newly discovered or rarely used chemicals may have an SID but not a CID.</p>
<p>For most users, the compound domain will provide the bulk of the information they need about their drugs of interest. The <code>getPubChemCompound</code> function has been included to allow users to easily query this domain.</p>
<div class="section level5">
<h5 id="common-use-cases">Common Use Cases<a class="anchor" aria-label="anchor" href="#common-use-cases"></a>
</h5>
<ol style="list-style-type: decimal">
<li>Get CID from Drug Names</li>
</ol>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">AnnotationGx</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span>
<span><span class="va">drugs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Erlotinib"</span>, <span class="st">"Acadesine"</span>, <span class="st">"Camptothecin"</span>, <span class="st">"Vincaleukoblastine"</span>,</span>
<span>    <span class="st">"Cisplatin"</span><span class="op">)</span></span>
<span><span class="va">namesToCID</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getPubChemCompound.html">getPubChemCompound</a></span><span class="op">(</span><span class="va">drugs</span>, from<span class="op">=</span><span class="st">'name'</span>, to<span class="op">=</span><span class="st">'cids'</span><span class="op">)</span></span></code></pre></div>
<p>It is possible for names to multimap to CIDs. This is the case for ‘Vincaleukoblastine’ in the above query. In cases of multimapping, usually the first entry has the highest similarity to the requested drug. To subset to only the first occurrence of each of drug name:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Using duplicated function</span></span>
<span><span class="va">noDuplicatesNamesToCID</span> <span class="op">&lt;-</span> <span class="va">namesToCID</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/duplicated.html" class="external-link">duplicated</a></span><span class="op">(</span><span class="va">name</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="co"># Using group-by operations</span></span>
<span><span class="va">noDuplicatesNamesToCID</span> <span class="op">&lt;-</span> <span class="va">namesToCID</span><span class="op">[</span>, <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/last.html" class="external-link">first</a></span><span class="op">(</span><span class="va">.SD</span><span class="op">)</span>, by<span class="op">=</span><span class="va">name</span><span class="op">]</span></span></code></pre></div>
<p>In cases with multimapping, we highly recommend you manually check that the CID you select is optimal. This can be done with a simple look up in PubChem via your web browser if there are only a few multimapped drugs. You can also keep all duplicates, then decide on the best option when fetching compound properties like this:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">multiIDs</span> <span class="op">&lt;-</span> <span class="va">namesToCID</span><span class="op">[</span><span class="va">name</span> <span class="op">==</span> <span class="st">'Vincaleukoblastine'</span>, <span class="op">]</span><span class="op">$</span><span class="va">cids</span></span>
<span><span class="va">CIDtoTitle</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getPubChemCompound.html">getPubChemCompound</a></span><span class="op">(</span><span class="va">multiIDs</span>, from<span class="op">=</span><span class="st">'cid'</span>, to<span class="op">=</span><span class="st">'property'</span>,</span>
<span>    properties<span class="op">=</span><span class="st">'Title'</span><span class="op">)</span></span></code></pre></div>
<p>Viewing the results, we can see that indeed the first CID is the best, as the Title of the PubChem entry is exactly our original query. Multimapping occurs because PubChem look-ups by name also consider synonyms.</p>
<p>For this reason, we recommend mapping from names to CID or SID first, then using those official PubChem identifiers to fetch additional information about your compound of interest.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract the mutlimapped IDs</span></span>
<span><span class="va">multiIDs</span> <span class="op">&lt;-</span> <span class="va">namesToCID</span><span class="op">[</span><span class="va">name</span> <span class="op">==</span> <span class="st">'Vincaleukoblastine'</span>, <span class="op">]</span><span class="op">$</span><span class="va">cids</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Get SID from Drug Names</li>
</ol>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">namesToSID</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getPubChemCompound.html">getPubChemCompound</a></span><span class="op">(</span><span class="va">drugs</span>, from<span class="op">=</span><span class="st">'name'</span>, to<span class="op">=</span><span class="st">'sids'</span><span class="op">)</span></span></code></pre></div>
<p>Multimapping is an even greater concern when fetching SIDs, since a single CID can map to many SIDs. As a result, we only recommend using SIDs for compounds which have no available CID.</p>
<ol start="3" style="list-style-type: decimal">
<li>Get Synonyms from Drug Names</li>
</ol>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">namesToSynonyms</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getPubChemCompound.html">getPubChemCompound</a></span><span class="op">(</span><span class="va">drugs</span>, from<span class="op">=</span><span class="st">'name'</span>, to<span class="op">=</span><span class="st">'synonyms'</span><span class="op">)</span></span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>Get Compound Properties from CIDs</li>
</ol>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cids</span> <span class="op">&lt;-</span> <span class="va">namesToCID</span><span class="op">$</span><span class="va">cids</span></span>
<span><span class="va">propertiesFromCID</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getPubChemCompound.html">getPubChemCompound</a></span><span class="op">(</span><span class="va">cids</span>,</span>
<span>    properties<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Title'</span>, <span class="st">'InChIKey'</span>, <span class="st">'CanonicalSMILES'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>A short-list of properties is available in the function documentation, see <code><a href="../reference/getPubChemCompound.html">?getPubChemCompound</a></code>. A link in the DETAILS section will take you to a full list of available compound properties in the PubChem API documentation.</p>
</div>
</div>
<div class="section level4">
<h4 id="querying-the-substance-domain">Querying the Substance Domain<a class="anchor" aria-label="anchor" href="#querying-the-substance-domain"></a>
</h4>
<p>The substance domain allows users to query a broader range of chemicals than the compounds domain. This can be useful if mappings from name or CID failed to get the information you are interested in.</p>
</div>
<div class="section level4">
<h4 id="querying-the-assay-domain">Querying the Assay Domain<a class="anchor" aria-label="anchor" href="#querying-the-assay-domain"></a>
</h4>
<p>A functions for making specific queries to the assay domain on the PUG REST API has not been implemented yet. A user could implement their own using the <code>queryPubChem</code> functions and knowledge of the PubChem API. It is possible we will add additional methods to query this domain to retrieve information such as drug targets or doseresponse metrics.</p>
</div>
<div class="section level4">
<h4 id="specialized-functions">Specialized functions<a class="anchor" aria-label="anchor" href="#specialized-functions"></a>
</h4>
<p>To make the package more user friendly, we have included a number of convenience functions which further limit the scope of queries, but require less knowledge of the underlying structure of the PubChem API. We hope that this will allow users with no knowledge or interest in details of the PubChem API to retrieve useful information nonetheless.</p>
<ol style="list-style-type: decimal">
<li>Mapping from NSC Number to CIDs</li>
</ol>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">NSC_numbers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1026L</span>, <span class="fl">1027L</span>, <span class="fl">1042L</span>, <span class="fl">1059L</span>, <span class="fl">1063L</span>, <span class="fl">1139L</span><span class="op">)</span></span>
<span><span class="va">NSCtoCID</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getPubChemFromNSC.html">getPubChemFromNSC</a></span><span class="op">(</span><span class="va">NSC_numbers</span>, to<span class="op">=</span><span class="st">'cids'</span><span class="op">)</span></span></code></pre></div>
<p>Additional functions mapping from external identifiers will be added as the need arises. Additional documentation will be added to this section at that time.</p>
</div>
<div class="section level4">
<h4 id="handling-failed-queries">Handling Failed queries<a class="anchor" aria-label="anchor" href="#handling-failed-queries"></a>
</h4>
<p>Queries to the PubChem API can fail for various reasons. Maybe there is a typo in your query identifiers, maybe some of the identifiers don’t map to any PubChem enteries, maybe there was a connection interuption during your query.</p>
<p>The functions in this package should provide a warning whenever queries fail. The identifiers for failed queries will be available as an attribute on the returned results. Retrying failed queries is particularly important when executing functions with <code>batch=TRUE</code>, since any failed mappings in a batch query will result in the entire query failing.</p>
<p>An example of extracting failed IDs and retrying with <code>batch=FALSE</code> is shown below.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">NSC_numbers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">756453</span>, <span class="fl">761266</span><span class="op">)</span></span>
<span><span class="va">NSCtoCID</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getPubChemFromNSC.html">getPubChemFromNSC</a></span><span class="op">(</span><span class="va">NSC_numbers</span>, batch<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># extract the failed queries</span></span>
<span><span class="va">failed</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">NSCtoCID</span><span class="op">)</span><span class="op">$</span><span class="va">failed</span></span>
<span><span class="va">failedQueries</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">failed</span>, FUN<span class="op">=</span><span class="va">`[[`</span>, i<span class="op">=</span><span class="st">'query'</span><span class="op">)</span></span>
<span><span class="va">failedIDs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">failedQueries</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># retry with batch=FALSE</span></span>
<span><span class="va">retryNSCtoCID</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getPubChemFromNSC.html">getPubChemFromNSC</a></span><span class="op">(</span><span class="va">failedIDs</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, batch<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="pubchem-pug-view-api">PubChem PUG VIEW API<a class="anchor" aria-label="anchor" href="#pubchem-pug-view-api"></a>
</h3>
<p>The PUG View API is primarily designed to provide summary reports of all external identifiers for a given PubChem entry. Each summary provides the values of external annotations, as well as links to their source database.</p>
<div class="section level4">
<h4 id="querying-individual-records">Querying Individual Records<a class="anchor" aria-label="anchor" href="#querying-individual-records"></a>
</h4>
<p>A function for querying individual PUG VIEW records has not been implemented yet. We will update this documentation as soon as we have the feature avaiable.</p>
</div>
<div class="section level4">
<h4 id="querying-annotations">Querying Annotations<a class="anchor" aria-label="anchor" href="#querying-annotations"></a>
</h4>
<p>The PubChem PUG View Annotations API provides summaries of third-party annotations across all PubChem records. These annotations are linked To PubChem compounds via CID and/or SID. This API does not allow specific input queries, instead returning the entire record for the user to parse and extract relevant information.</p>
<p>To determine what kind of annotations are available, you can get a list of headers by calling the function with no arguments:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">headers</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getPubChemAnnotations.html">getPubChemAnnotations</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co"># %like% is a convenient way to do regex subsets on a data.table</span></span>
<span><span class="co">#&gt;it is equivalent to grepl('ATC', Heading)</span></span>
<span><span class="va">headers</span><span class="op">[</span><span class="va">Heading</span> <span class="op"><a href="https://Rdatatable.gitlab.io/data.table/reference/like.html" class="external-link">%like%</a></span> <span class="st">'ATC'</span>, <span class="op">]</span></span></code></pre></div>
<p>You can see additional documentation for this function using <code><a href="../reference/getPubChemAnnotations.html">?getPubChemAnnotations</a></code> from the R console.</p>
<ol style="list-style-type: decimal">
<li>Getting All ATC Codes</li>
</ol>
<p><strong>WARNING: these functions are poorly tested and may not work</strong></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CIDtoATC</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getPubChemAnnotations.html">getPubChemAnnotations</a></span><span class="op">(</span><span class="st">'ATC Codes'</span><span class="op">)</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Getting All NSC Numbers</li>
</ol>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CIDtoNSC</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getPubChemAnnotations.html">getPubChemAnnotations</a></span><span class="op">(</span><span class="st">'NSC Number'</span><span class="op">)</span></span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Getting All CTD Codes</li>
</ol>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CIDtoCTD</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getPubChemAnnotations.html">getPubChemAnnotations</a></span><span class="op">(</span><span class="st">'CTD Chemical-Gene Interactions'</span><span class="op">)</span></span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>Getting All DILI Statuses</li>
</ol>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CIDtoDILI</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getPubChemAnnotations.html">getPubChemAnnotations</a></span><span class="op">(</span><span class="st">'Drug Induced Liver Injury'</span><span class="op">)</span></span></code></pre></div>
<ol start="5" style="list-style-type: decimal">
<li>Getting All CAS Registry Numbers</li>
</ol>
<p>The PubChem PUG VIEW API has many records with valid CAS identifiers, therefore this function can be very slow. Since it returns values for ALL PubChem records, it should only need to be run once. Subsequent look-ups can be done from the resulting <code>data.table</code> based on CID or SID. Make sure to save the file as soon as this function returns to prevent having to run it again.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CIDtoCAS</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getPubChemAnnotations.html">getPubChemAnnotations</a></span><span class="op">(</span><span class="st">'CAS'</span><span class="op">)</span></span></code></pre></div>
<ol start="6" style="list-style-type: decimal">
<li>Getting All Compound Synonyms</li>
</ol>
<p>While it is generally faster and more efficient to use the <code>getPubChemCompound</code> function to look up synonyms based on some known identifier, it may be useful to get an exaustive list of synonyms when other mapping methods fail.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">headers</span><span class="op">[</span><span class="va">Heading</span> <span class="op"><a href="https://Rdatatable.gitlab.io/data.table/reference/like.html" class="external-link">%like%</a></span> <span class="st">'Syn'</span><span class="op">]</span></span></code></pre></div>
<p>Here we can see that there are two options for looking up compound synonyms available via the PUG VIEW API. We can get results for both.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CIDtoNamesAndSyn</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getPubChemAnnotations.html">getPubChemAnnotations</a></span><span class="op">(</span><span class="st">'Names and Synonyms'</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CIDtoSynAndIDs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getPubChemAnnotations.html">getPubChemAnnotations</a></span><span class="op">(</span><span class="st">'Synonyms and Identifiers'</span><span class="op">)</span></span></code></pre></div>
<ol start="7" style="list-style-type: decimal">
<li>Other Annotations</li>
</ol>
<p>The <code>getPubChemAnnotations</code> function supports arbitrary annotation headers. We have included default parsing functions to take the raw query results for the use cases above and return a well formatted table of result data.</p>
<p>However, users wishing to retrieve other annotations can do so. By defaults the results will be returned as single <code>data.table</code> which the user will need to process into something usable. If you find you are often retreiving the same kind of annotations, it is also possible for developers to write a custom parser function which will automatically format the results before they are returned.</p>
<p>This function should be passed to the <code>parseFUN</code> parameter, and should accept the unparsed return of the function and process it to the desired output. If you have some efficient parse functions you would like to see added as defaults in the package please feel free to open an Issue or Pull Request on our GitHub page.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ol style="list-style-type: decimal">
<li>PUG REST. PubChem Docs [website]. Retrieved from <a href="https://pubchemdocs.ncbi.nlm.nih.gov/pug-rest" class="external-link uri">https://pubchemdocs.ncbi.nlm.nih.gov/pug-rest</a>.</li>
<li>Kim S, Thiessen PA, Cheng T, Yu B, Bolton EE. An update on PUG-REST: RESTful interface for programmatic access to PubChem. Nucleic Acids Res. 2018 July 2; 46(W1):W563-570. <a href="doi:10.1093/nar/gky294" class="uri">doi:10.1093/nar/gky294</a>.</li>
<li>PUG VIEW. PubChem Docs [webiste]. Retrieved from <a href="https://pubchemdocs.ncbi.nlm.nih.gov/pug-view" class="external-link uri">https://pubchemdocs.ncbi.nlm.nih.gov/pug-view</a>.</li>
<li>Kim S, Thiessen PA, Cheng T, Zhang J, Gindulyte A, Bolton EE. PUG-View: programmatic access to chemical annotations integrated in PubChem. J Cheminform. 2019 Aug 9; 11:56. <a href="doi:10.1186/s13321-019-0375-2" class="uri">doi:10.1186/s13321-019-0375-2</a>.</li>
</ol>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Christopher Eeles, Sisira Nair, Petr Smirnov, Shahzada Farooq, Benjamin Haibe-Kains.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
